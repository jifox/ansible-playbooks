{% set ns = namespace(is_vlan_defined = false) %}
{% set ns.is_first = true %}
---
#
# file: host_vars/{{inventory_hostname}}/device_vlans.yml
#
# DO NOT CHANGE! Automatically generated by
#   gen_device_specific_vars_from_fabric.yml
#
# device_vlans:
#   "VLAN-ID":          (string  "1"-"4094")  Unique VLAN-ID
#      vlan_name:       (string)              Unique VLAN Name
#      vlan_dhcp_snoop: (bool)                default: false <--  ip dhcp snooping will be defined
#                                                                 for this vlan if set to true
#
{% for vl in vlan_db.vlan_defines %}
{%   set vldata=vlan_db.vlan_defines[vl] %}
{%   set ns.is_vlan_defined = false %}
{%   for loc in switch_location %}
{%     if loc in vldata.vlan_deploy %}
{%       set ns.is_vlan_defined = true %}
{%     endif %}
{%   endfor %}
{%   if ns.is_vlan_defined %}
{%     if ns.is_first %}
{%       set ns.is_first = false %}
device_vlans:
{%     endif %}
  "{{ vl }}":
    vlan_name: "{{ vldata.vlan_name }}"
    vlan_dhcp_snoop: {{ 'true' if vldata.vlan_dhcp_snoop is defined and vldata.vlan_dhcp_snoop else 'false' }}
{%   endif %}
{% endfor %}